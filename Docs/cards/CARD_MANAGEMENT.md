# カード管理システム仕様

## ワールド設定

### 基本設定

-   最大収容人数：32 人
-   対戦台設置数：5 台
-   1 人あたりのデッキ保持数：1 個

### 対戦エリア管理

-   5 台の対戦台を効率的に配置
-   各対戦台周辺に観戦スペースを確保
-   対戦台ごとのフォーマット選択機能

## フォーマット管理

### 対応フォーマット

1. スタンダード（Standard）

    - 最新のセットから約 2 年分
    - 定期的な使用可能カードの更新
    - ローテーション時期の管理

2. パイオニア（Pioneer）

    - 『リターン・トゥ・ラヴニカ』以降
    - 禁止カードリストの管理
    - 使用可能セットの管理

3. モダン（Modern）

    - 第 8 版以降のカード
    - 禁止カードリストの管理
    - モダン・ホライゾンシリーズ対応

4. レガシー（Legacy）

    - すべてのセット対応
    - 厳格な禁止カードリスト管理
    - 特殊カードタイプの対応

5. ヴィンテージ（Vintage）

    - すべてのセット対応
    - 制限カードリスト管理（1 枚制限）
    - 禁止カードの最小限化

6. パウパー（Pauper）
    - コモン・レアリティのみ
    - すべてのセットのコモンカード対応
    - フォーマット特有の禁止リスト

### 禁止制限システム

1. データ構造

```json
{
	"formatRules": {
		"standard": {
			"bannedCards": ["カード名1", "カード名2"],
			"restrictedCards": [],
			"validSets": ["最新セット", "セット2"],
			"lastUpdate": "2025-04-01"
		}
	}
}
```

2. 更新管理

    - 定期的な禁止制限リストの更新
    - フォーマットごとの有効セット管理
    - 更新履歴の保持

3. 実装機能
    - デッキ構築時の禁止カードチェック
    - フォーマット別のデッキバリデーション
    - 制限カードの枚数チェック

## カード登録システム

### データベース構造

1. カードマスターデータ

```json
{
	"cardId": "unique_id",
	"name": {
		"ja": "日本語カード名",
		"en": "英語カード名"
	},
	"sets": [
		{
			"setCode": "SetCode",
			"rarity": "Rare",
			"number": "001/274"
		}
	],
	"cardType": ["Creature"],
	"manaCost": "{2}{B}",
	"power": "2",
	"toughness": "2",
	"text": {
		"ja": "カードテキスト",
		"en": "Card text"
	},
	"formats": ["Standard", "Modern", "Legacy"],
	"legality": {
		"standard": "legal",
		"modern": "banned",
		"legacy": "restricted"
	}
}
```

2. セットデータ

```json
{
	"setCode": "SetCode",
	"name": {
		"ja": "セット名",
		"en": "Set Name"
	},
	"releaseDate": "2025-04-01",
	"totalCards": 274,
	"formats": ["Standard", "Modern"]
}
```

### カード登録プロセス

1. 一括登録システム

    - CSV インポート機能
    - JSON 形式での一括登録
    - セット単位での登録

2. 個別登録機能

    - 管理者用カード登録 UI
    - カード情報の手動入力
    - 画像データの登録

3. データ検証
    - カード情報の整合性チェック
    - 重複登録の防止
    - 必須項目の検証

### アセット管理

1. カード画像

    - 高解像度画像の保存
    - テクスチャの最適化
    - アトラス化による効率化

2. データ圧縮
    - テクスチャ圧縮の最適化
    - メモリ使用量の削減
    - ロード時間の最適化

### 更新システム

1. カードデータ

    - 新セット追加時の更新
    - エラッタ対応
    - フォーマット変更の反映

2. 禁止制限

    - 定期的な更新チェック
    - 自動更新システム
    - 更新通知機能

3. バックアップ
    - データの定期バックアップ
    - ロールバック機能
    - 更新履歴の管理

## 運用管理

1. エラー対応

    - データ不整合の検出
    - 自動修復機能
    - エラーログの記録

2. パフォーマンス最適化

    - キャッシュ管理
    - インデックス最適化
    - クエリ効率化

3. セキュリティ
    - データ改ざん防止
    - アクセス制御
    - 監査ログ
