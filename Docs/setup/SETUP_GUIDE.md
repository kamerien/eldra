# MTG カードシステムセットアップガイド

## 初期セットアップ

1. プロジェクトの準備

```
- Unity 2022.3.6f1をインストール
- VRChat Creator Companion (VCC)をインストール
- プロジェクトにVRChat SDK3をインポート
- UdonSharpをインポート
```

2. フォルダ構造の作成

```
Assets/
  ├── Resources/
  │   ├── CardData/      # カードデータJSON
  │   └── CardTextures/  # テクスチャアトラス
  ├── Scripts/
  │   └── Card/         # カード関連スクリプト
  ├── Editor/           # エディタ拡張
  └── Tools/           # データ取得ツール
```

3. スクリプトのインポート

-   `CardDataManager.cs` を Scripts/Card/ フォルダに配置
-   `CardResourceLoader.cs` を Scripts/Card/ フォルダに配置
-   `ScryfallDataFetcher.cs` を Tools/ フォルダに配置
-   `CardDataManagerEditor.cs` を Editor/ フォルダに配置

## カードデータの初期化

1. Scryfall API からデータを取得

```
a. Unity Editorを開く
b. プロジェクトビューでCardDataManagerを選択
c. インスペクタの "Fetch Card Data" ボタンをクリック
d. データのダウンロードと処理が完了するまで待機
```

2. テクスチャアトラスの生成

```
a. カードデータ取得完了後、"Generate Atlas" ボタンをクリック
b. テクスチャの最適化とアトラス生成を待機
```

3. リソースのビルド

```
a. "Build All Resources" ボタンをクリック
b. 全リソースの最適化とキャッシュ生成を待機
```

## VRChat ワールドへの実装

1. プレハブの配置

```
a. シーンにCardManagerプレハブをドラッグ＆ドロップ
b. 必要なフォーマットの設定を有効化
c. メモリ設定を調整（必要に応じて）
```

2. デッキ管理の設定

```
a. DeckManagerコンポーネントの設定
b. カードプレハブの割り当て
c. プレイエリアの設定
```

3. UI 設定

```
a. GameUIコンポーネントの設定
b. プレイヤーUIの配置
c. 情報表示の調整
```

## パフォーマンス最適化

1. メモリ使用量の最適化

```
- テクスチャアトラスの設定確認
- キャッシュサイズの調整
- 未使用リソースの解放タイミング設定
```

2. ネットワーク同期の最適化

```
- 同期変数の使用を最小限に
- バッチ処理の活用
- オーナーシップの適切な管理
```

## トラブルシューティング

1. カードデータの更新

```
a. キャッシュのクリア
b. データの再取得
c. アトラスの再生成
```

2. パフォーマンスの問題

```
a. デバッグレポートの生成
b. メモリ使用量の確認
c. 同期状態の確認
```

3. エラー対応

```
a. ログの確認
b. データの整合性チェック
c. キャッシュの再構築
```

## メンテナンス

1. 定期的なアップデート

```
- 新セット追加時のデータ更新
- 禁止制限リストの更新
- テクスチャの最適化チェック
```

2. キャッシュ管理

```
- 未使用データの定期的なクリーンアップ
- パフォーマンスモニタリング
- エラーログの確認
```

## 注意事項

1. VRChat の制限

```
- 同期変数の制限に注意
- メモリ使用量の制限
- ネットワーク帯域の考慮
```

2. 最適化のヒント

```
- 必要なカードのみをロード
- テクスチャメモリの効率的な使用
- 適切なキャッシュ戦略の採用
```
